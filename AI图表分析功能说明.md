# AI图表分析功能说明

## 功能概述

AI图表分析功能能够根据您上传的Excel数据，不仅提供文字分析，还能自动生成相关的图表，实现图表和文字结合的专业分析展示。

## 支持的图表类型

### 1. 生产数据分析图表
- **生产效率对比图** - 柱状图显示各产品的生产效率
- **缺陷率趋势图** - 折线图显示各产品的缺陷率变化
- **生产趋势图** - 折线图显示月度生产数量趋势

### 2. 销售数据分析图表
- **销售额对比图** - 柱状图显示各产品的销售额
- **利润率分布图** - 饼图显示各产品的利润率分布
- **地区销售表现图** - 柱状图显示各地区的销售表现

### 3. 库存数据分析图表
- **库存水平图** - 柱状图显示各产品的库存水平
- **仓库分布图** - 饼图显示各仓库的库存分布

### 4. 客户反馈分析图表
- **满意度评分图** - 柱状图显示各产品的客户满意度
- **反馈类型分布图** - 饼图显示客户反馈类型分布

## 使用方法

### 1. 启动应用
```bash
mvn spring-boot:run
```

### 2. 上传数据
按照 `Excel模板创建说明.md` 创建并上传Excel文件

### 3. 提问分析
在AI对话窗口中输入问题，例如：
- "分析一下生产效率和缺陷率情况，并生成相关图表"
- "销售数据表现如何，请生成销售趋势图表"
- "库存是否存在风险，请生成库存分布图表"
- "客户满意度如何，请生成满意度分析图表"

### 4. 查看结果
AI会返回：
- 详细的文字分析报告
- 相关的数据图表
- 具体的改进建议

## 快速问题按钮

页面提供了4个快速问题按钮，点击即可快速获得图表分析：

1. **生产效率分析** - 生成生产效率和缺陷率相关图表
2. **销售表现** - 生成销售趋势和利润率图表
3. **库存风险** - 生成库存分布和风险分析图表
4. **客户满意度** - 生成满意度和反馈类型图表

## 图表特性

### 交互功能
- **悬停提示** - 鼠标悬停显示详细数据
- **响应式设计** - 自动适应不同屏幕尺寸
- **动画效果** - 平滑的图表加载动画

### 图表样式
- **专业配色** - 使用统一的蓝色主题
- **清晰布局** - 图表标题和轴标签清晰可见
- **美观设计** - 现代化的图表外观

## 技术实现

### 后端功能
- **智能数据识别** - 根据问题关键词自动识别相关数据
- **图表数据生成** - 将Excel数据转换为图表所需格式
- **多图表支持** - 支持柱状图、折线图、饼图等多种类型

### 前端功能
- **动态图表渲染** - 使用ECharts库渲染图表
- **实时更新** - 图表随数据变化实时更新
- **响应式布局** - 图表自动适应容器大小

## 示例问题

### 生产相关问题
- "分析一下生产效率和缺陷率情况，并生成相关图表"
- "哪个生产线的表现最好？请用图表展示"
- "生产成本的趋势如何？生成趋势图"

### 销售相关问题
- "销售数据表现如何，请生成销售趋势图表"
- "哪个地区的销售表现最好？用图表对比"
- "不同销售渠道的利润率对比，生成饼图"

### 库存相关问题
- "库存是否存在风险，请生成库存分布图表"
- "哪些产品存在缺货风险？用图表展示"
- "库存周转率如何？生成趋势图"

### 客户反馈相关问题
- "客户满意度如何，请生成满意度分析图表"
- "主要的客户投诉是什么？用图表展示"
- "客户建议最多的改进点是什么？生成分布图"

## 注意事项

1. **数据完整性** - 确保上传的Excel数据完整，以获得准确的图表
2. **问题描述** - 在问题中明确要求生成图表，如"请生成图表"、"用图表展示"等
3. **图表数量** - 每次分析最多生成3-4个相关图表
4. **浏览器兼容** - 建议使用现代浏览器以获得最佳图表显示效果

## 故障排除

### 常见问题
1. **图表不显示** - 检查浏览器是否支持ECharts
2. **数据不准确** - 确认Excel数据格式正确
3. **图表加载慢** - 检查网络连接和服务器状态

### 优化建议
1. **数据量控制** - 避免上传过大的Excel文件
2. **问题具体化** - 提出具体的问题以获得更精准的图表
3. **定期更新** - 定期上传最新数据以获得最新分析 